function init(){function t(){var t=i.indexOf(s);t>0&&_.times(t,function(t){i[t].setComplete()}),s.open()}var e=(_.map($$("[data-product-features]"),function(t){return new ProductFeatures(t)}),_.map($$("[data-customize-link]"),function(t){return new AccordionCustomizeLink(t)})),i=_.map($$("[data-section]"),function(t,n){var s=t.get("data-section"),o=new window["Accordion"+s+"Section"](t);return o.addEvents({change:function(t){_.each(e,function(e){e.setData(o.name,t.value)});var n,s,r,a;"bundle"===o.name&&(n=_.findWhere(i,{name:"timing"}),s=n.getValue(),r=s.data.value.toInt()/30,a=t.data.cost.toFloat().toFixed(2),_.each($$('[data-name="shipment_cost"]'),function(t){t.set("text","$"+a)}),_.each($$('[data-name="month_cost"]'),function(t){t.set("text","$"+(a/r).toFixed(2))}))},complete:function(t){var s=_.where(i,{type:"review"});_.each(s,function(e){e.setData(o.name,t.data)}),_.each(e,function(e){e.setData(o.name,t.value)});var r=i[n+1];r&&(o.close(),r.open())},open:function(){_.each(i,function(t,e){e>n&&t.unsetComplete(),e===n+1?t.setNext():e>n+1&&t.unsetNext(),t!==o&&t.close()})},close:function(){},next_open:function(){var t=i[n-1];t&&t.setComplete()}}),"bundle"===o.name&&(o.options.beforeOpen=function(t){var e,n,s,r,a=_.findWhere(i,{name:"timing"});a&&(e=a.getValue(),n=e.data.value.toInt()/30,s=o.getValue(),r=s.data.cost.toFloat().toFixed(2),_.each($$('[data-name="interval"]'),function(t){t.set("text",n)}),_.each($$('[data-name="shipment_cost"]'),function(t){t.set("text","$"+r)}),_.each($$('[data-name="month_cost"]'),function(t){t.set("text","$"+(r/n).toFixed(2))}),_.each(this.choices,function(t){var e,i=o.root_el.getElement('[data-value="'+t.data.value+'"] .bundle-cost');t.data.cost&&(e=t.data.cost.toInt()/n,i.set("text",e.toFloat().toFixed(2)));var s,r=o.root_el.getElement('[data-value="'+t.data.value+'"] .non-bundle-cost');t.data.non_bundle_cost&&(s=t.data.non_bundle_cost.toInt()/n,r.set("text","$"+s.toFloat().toFixed(2)))})),t()}.bind(o)),o}),n=_.map($$("[data-modal]"),function(t){return new MoreInfoModal(t)});_.each($$("[data-action]"),function(t){var e=t.get("data-action"),i=t.get("data-name"),s=_.findWhere(n,{type:e});t.addEvent("click",function(){s.setup(i).show()})});var s,o=new URI(document.location).get("data");s=o.start?_.findWhere(i,{name:o.start}):i[0],s.complete?t():s.addEvent("load",t);var r=new URI;query_string=r.parsed.query,query_string&&"success"===query_string.parseQueryString().survey_response&&new Flash(I18n.t("auto_refill_build.survey.success"),"notice")}var AccordionSection=new Class({Implements:[Events,Options],options:{next_button_selector:".content button",closed_padding:20,complete_hover_height:55,beforeOpen:function(t){t()},beforeClose:function(t){t()}},initialize:function(t,e){this.setOptions(e),this.root_el=t,this.name=this.root_el.get("data-name"),this.start="true"===this.root_el.get("data-start"),this.next_button=this._setupNextButton(this.options.next_button_selector),this.options.closed_height=this.root_el.getElement(".header").getSize().y,this.overlay_els=this.root_el.getElements(".overlay"),async.each(this.root_el.getElements("img"),function(t,e){t.complete?e():t.addEvent("load",e)},function(){this.complete=!0,this.fireEvent("load")}.bind(this))},_setupNextButton:function(t){var e=this.root_el.getElement(t),i=new Button(e);return i.addEvent("click",function(t){t.stopPropagation(),this.isValid()&&this.setComplete()}.bind(this)),i},isValid:function(){return!0},isComplete:function(){return this.root_el.hasClass("complete")},setComplete:function(){return this.root_el.addClass("complete").addEvents({click:function(){this.unsetComplete().open()}.bind(this),mouseover:this.sneakPeek.bind(this),mouseout:this.close.bind(this)}),this.fireEvent("complete",this.getValue()),this},unsetComplete:function(){return this.root_el.removeClass("complete").removeEvents(),this.fireEvent("uncomplete"),this},setNext:function(){this.root_el.addClass("next").addEvent("click",function(){this.fireEvent("next_open")}.bind(this))},unsetNext:function(){this.root_el.removeClass("next").removeEvents()},measureHeight:function(){var t=2*this.options.closed_padding;return this.root_el.measure(function(){var e=this.getHeight();this.setStyles({transition:"none",height:"auto"});var i=this.getSize().y-t;return this.setStyles({transition:"",height:e-t}),i})},scrollToRoot:function(){this.win_scroll=this.win_scroll||new Fx.Scroll(window,{offset:{x:0,y:-50},link:"chain",wheelStops:!0}),this.win_scroll.toElement(this.root_el)},scrollToTop:function(){this.win_scroll=this.win_scroll||new Fx.Scroll(window,{offset:{x:0,y:-50},link:"chain",wheelStops:!0}),this.win_scroll.toTop()},open:function(){return this.options.beforeOpen(function(){this.root_el.removeClass("closed").setStyles({height:this.measureHeight()}),this.unsetNext(),Harrys.IS_MOBILE&&setTimeout(this.scrollToTop.bind(this),500),this.fireEvent("open"),_.each(this.overlay_els,function(t){t.fade("in")})}.bind(this)),this},close:function(){return this.options.beforeClose(function(){this.root_el.addClass("closed").setStyles({height:this.options.closed_height}),_.each(this.overlay_els,function(t){t.fade("out")}),this.fireEvent("close")}.bind(this)),this},sneakPeek:function(){Browser.ie8||Browser.ie9||this.root_el.setStyle("height",this.options.complete_hover_height)}});/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
!function(t,e,i,n){"use strict";function s(t,e,i){return setTimeout(h(t,i),e)}function o(t,e,i){return Array.isArray(t)?(r(t,i[e],i),!0):!1}function r(t,e,i){var s;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==n)for(s=0;s<t.length;)e.call(i,t[s],s,t),s++;else for(s in t)t.hasOwnProperty(s)&&e.call(i,t[s],s,t)}function a(t,e,i){for(var s=Object.keys(e),o=0;o<s.length;)(!i||i&&t[s[o]]===n)&&(t[s[o]]=e[s[o]]),o++;return t}function c(t,e){return a(t,e,!0)}function l(t,e,i){var n,s=e.prototype;n=t.prototype=Object.create(s),n.constructor=t,n._super=s,i&&a(n,i)}function h(t,e){return function(){return t.apply(e,arguments)}}function u(t,e){return typeof t==he?t.apply(e?e[0]||n:n,e):t}function d(t,e){return t===n?e:t}function p(t,e,i){r(_(e),function(e){t.addEventListener(e,i,!1)})}function m(t,e,i){r(_(e),function(e){t.removeEventListener(e,i,!1)})}function f(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function v(t,e){return t.indexOf(e)>-1}function _(t){return t.trim().split(/\s+/g)}function g(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function y(t){return Array.prototype.slice.call(t,0)}function E(t,e,i){for(var n=[],s=[],o=0;o<t.length;){var r=e?t[o][e]:t[o];g(s,r)<0&&n.push(t[o]),s[o]=r,o++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function b(t,e){for(var i,s,o=e[0].toUpperCase()+e.slice(1),r=0;r<ce.length;){if(i=ce[r],s=i?i+o:e,s in t)return s;r++}return n}function T(){return me++}function w(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}function C(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){u(t.options.enable,[t])&&i.handler(e)},this.init()}function I(t){var e,i=t.options.inputClass;return new(e=i?i:_e?B:ge?L:ve?U:N)(t,A)}function A(t,e,i){var n=i.pointers.length,s=i.changedPointers.length,o=e&Ce&&n-s===0,r=e&(Ae|Se)&&n-s===0;i.isFirst=!!o,i.isFinal=!!r,o&&(t.session={}),i.eventType=e,S(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function S(t,e){var i=t.session,n=e.pointers,s=n.length;i.firstInput||(i.firstInput=H(e)),s>1&&!i.firstMultiple?i.firstMultiple=H(e):1===s&&(i.firstMultiple=!1);var o=i.firstInput,r=i.firstMultiple,a=r?r.center:o.center,c=e.center=D(n);e.timeStamp=pe(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=q(a,c),e.distance=M(a,c),x(i,e),e.offsetDirection=z(e.deltaX,e.deltaY),e.scale=r?P(r.pointers,n):1,e.rotation=r?R(r.pointers,n):0,F(i,e);var l=t.element;f(e.srcEvent.target,l)&&(l=e.srcEvent.target),e.target=l}function x(t,e){var i=e.center,n=t.offsetDelta||{},s=t.prevDelta||{},o=t.prevInput||{};(e.eventType===Ce||o.eventType===Ae)&&(s=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=s.x+(i.x-n.x),e.deltaY=s.y+(i.y-n.y)}function F(t,e){var i,s,o,r,a=t.lastInterval||e,c=e.timeStamp-a.timeStamp;if(e.eventType!=Se&&(c>we||a.velocity===n)){var l=a.deltaX-e.deltaX,h=a.deltaY-e.deltaY,u=O(c,l,h);s=u.x,o=u.y,i=de(u.x)>de(u.y)?u.x:u.y,r=z(l,h),t.lastInterval=e}else i=a.velocity,s=a.velocityX,o=a.velocityY,r=a.direction;e.velocity=i,e.velocityX=s,e.velocityY=o,e.direction=r}function H(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:ue(t.pointers[i].clientX),clientY:ue(t.pointers[i].clientY)},i++;return{timeStamp:pe(),pointers:e,center:D(e),deltaX:t.deltaX,deltaY:t.deltaY}}function D(t){var e=t.length;if(1===e)return{x:ue(t[0].clientX),y:ue(t[0].clientY)};for(var i=0,n=0,s=0;e>s;)i+=t[s].clientX,n+=t[s].clientY,s++;return{x:ue(i/e),y:ue(n/e)}}function O(t,e,i){return{x:e/t||0,y:i/t||0}}function z(t,e){return t===e?xe:de(t)>=de(e)?t>0?Fe:He:e>0?De:Oe}function M(t,e,i){i||(i=Re);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return Math.sqrt(n*n+s*s)}function q(t,e,i){i||(i=Re);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return 180*Math.atan2(s,n)/Math.PI}function R(t,e){return q(e[1],e[0],Pe)-q(t[1],t[0],Pe)}function P(t,e){return M(e[0],e[1],Pe)/M(t[0],t[1],Pe)}function N(){this.evEl=Be,this.evWin=ke,this.allow=!0,this.pressed=!1,C.apply(this,arguments)}function B(){this.evEl=Ve,this.evWin=Ue,C.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function k(){this.evTarget=Ye,this.evWin=Xe,this.started=!1,C.apply(this,arguments)}function $(t,e){var i=y(t.touches),n=y(t.changedTouches);return e&(Ae|Se)&&(i=E(i.concat(n),"identifier",!0)),[i,n]}function L(){this.evTarget=Ze,this.targetIds={},C.apply(this,arguments)}function V(t,e){var i=y(t.touches),n=this.targetIds;if(e&(Ce|Ie)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var s,o,r=y(t.changedTouches),a=[],c=this.target;if(o=i.filter(function(t){return f(t.target,c)}),e===Ce)for(s=0;s<o.length;)n[o[s].identifier]=!0,s++;for(s=0;s<r.length;)n[r[s].identifier]&&a.push(r[s]),e&(Ae|Se)&&delete n[r[s].identifier],s++;return a.length?[E(o.concat(a),"identifier",!0),a]:void 0}function U(){C.apply(this,arguments);var t=h(this.handler,this);this.touch=new L(this.manager,t),this.mouse=new N(this.manager,t)}function W(t,e){this.manager=t,this.set(e)}function Y(t){if(v(t,ei))return ei;var e=v(t,ii),i=v(t,ni);return e&&i?ii+" "+ni:e||i?e?ii:ni:v(t,ti)?ti:Je}function X(t){this.id=T(),this.manager=null,this.options=c(t||{},this.defaults),this.options.enable=d(this.options.enable,!0),this.state=si,this.simultaneous={},this.requireFail=[]}function G(t){return t&li?"cancel":t&ai?"end":t&ri?"move":t&oi?"start":""}function Z(t){return t==Oe?"down":t==De?"up":t==Fe?"left":t==He?"right":""}function j(t,e){var i=e.manager;return i?i.get(t):t}function K(){X.apply(this,arguments)}function Q(){K.apply(this,arguments),this.pX=null,this.pY=null}function J(){K.apply(this,arguments)}function te(){X.apply(this,arguments),this._timer=null,this._input=null}function ee(){K.apply(this,arguments)}function ie(){K.apply(this,arguments)}function ne(){X.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function se(t,e){return e=e||{},e.recognizers=d(e.recognizers,se.defaults.preset),new oe(t,e)}function oe(t,e){e=e||{},this.options=c(e,se.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=I(this),this.touchAction=new W(this,this.options.touchAction),re(this,!0),r(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function re(t,e){var i=t.element;r(t.options.cssProps,function(t,n){i.style[b(i.style,n)]=e?t:""})}function ae(t,i){var n=e.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var ce=["","webkit","moz","MS","ms","o"],le=e.createElement("div"),he="function",ue=Math.round,de=Math.abs,pe=Date.now,me=1,fe=/mobile|tablet|ip(ad|hone|od)|android/i,ve="ontouchstart"in t,_e=b(t,"PointerEvent")!==n,ge=ve&&fe.test(navigator.userAgent),ye="touch",Ee="pen",be="mouse",Te="kinect",we=25,Ce=1,Ie=2,Ae=4,Se=8,xe=1,Fe=2,He=4,De=8,Oe=16,ze=Fe|He,Me=De|Oe,qe=ze|Me,Re=["x","y"],Pe=["clientX","clientY"];C.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)}};var Ne={mousedown:Ce,mousemove:Ie,mouseup:Ae},Be="mousedown",ke="mousemove mouseup";l(N,C,{handler:function(t){var e=Ne[t.type];e&Ce&&0===t.button&&(this.pressed=!0),e&Ie&&1!==t.which&&(e=Ae),this.pressed&&this.allow&&(e&Ae&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:be,srcEvent:t}))}});var $e={pointerdown:Ce,pointermove:Ie,pointerup:Ae,pointercancel:Se,pointerout:Se},Le={2:ye,3:Ee,4:be,5:Te},Ve="pointerdown",Ue="pointermove pointerup pointercancel";t.MSPointerEvent&&(Ve="MSPointerDown",Ue="MSPointerMove MSPointerUp MSPointerCancel"),l(B,C,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),s=$e[n],o=Le[t.pointerType]||t.pointerType,r=o==ye,a=g(e,t.pointerId,"pointerId");s&Ce&&(0===t.button||r)?0>a&&(e.push(t),a=e.length-1):s&(Ae|Se)&&(i=!0),0>a||(e[a]=t,this.callback(this.manager,s,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),i&&e.splice(a,1))}});var We={touchstart:Ce,touchmove:Ie,touchend:Ae,touchcancel:Se},Ye="touchstart",Xe="touchstart touchmove touchend touchcancel";l(k,C,{handler:function(t){var e=We[t.type];if(e===Ce&&(this.started=!0),this.started){var i=$.call(this,t,e);e&(Ae|Se)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:ye,srcEvent:t})}}});var Ge={touchstart:Ce,touchmove:Ie,touchend:Ae,touchcancel:Se},Ze="touchstart touchmove touchend touchcancel";l(L,C,{handler:function(t){var e=Ge[t.type],i=V.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:ye,srcEvent:t})}}),l(U,C,{handler:function(t,e,i){var n=i.pointerType==ye,s=i.pointerType==be;if(n)this.mouse.allow=!1;else if(s&&!this.mouse.allow)return;e&(Ae|Se)&&(this.mouse.allow=!0),this.callback(t,e,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var je=b(le.style,"touchAction"),Ke=je!==n,Qe="compute",Je="auto",ti="manipulation",ei="none",ii="pan-x",ni="pan-y";W.prototype={set:function(t){t==Qe&&(t=this.compute()),Ke&&(this.manager.element.style[je]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return r(this.manager.recognizers,function(e){u(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Y(t.join(" "))},preventDefaults:function(t){if(!Ke){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var n=this.actions,s=v(n,ei),o=v(n,ni),r=v(n,ii);return s||o&&i&ze||r&&i&Me?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var si=1,oi=2,ri=4,ai=8,ci=ai,li=16,hi=32;X.prototype={defaults:{},set:function(t){return a(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(o(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=j(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return o(t,"dropRecognizeWith",this)?this:(t=j(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(o(t,"requireFailure",this))return this;var e=this.requireFail;return t=j(t,this),-1===g(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(o(t,"dropRequireFailure",this))return this;t=j(t,this);var e=g(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(i.options.event+(e?G(n):""),t)}var i=this,n=this.state;ai>n&&e(!0),e(),n>=ai&&e(!0)},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=hi)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(hi|si)))return!1;t++}return!0},recognize:function(t){var e=a({},t);return u(this.options.enable,[this,e])?(this.state&(ci|li|hi)&&(this.state=si),this.state=this.process(e),void(this.state&(oi|ri|ai|li)&&this.tryEmit(e))):(this.reset(),void(this.state=hi))},process:function(){},getTouchAction:function(){},reset:function(){}},l(K,X,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(oi|ri),s=this.attrTest(t);return n&&(i&Se||!s)?e|li:n||s?i&Ae?e|ai:e&oi?e|ri:oi:hi}}),l(Q,K,{defaults:{event:"pan",threshold:10,pointers:1,direction:qe},getTouchAction:function(){var t=this.options.direction,e=[];return t&ze&&e.push(ni),t&Me&&e.push(ii),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,s=t.direction,o=t.deltaX,r=t.deltaY;return s&e.direction||(e.direction&ze?(s=0===o?xe:0>o?Fe:He,i=o!=this.pX,n=Math.abs(t.deltaX)):(s=0===r?xe:0>r?De:Oe,i=r!=this.pY,n=Math.abs(t.deltaY))),t.direction=s,i&&n>e.threshold&&s&e.direction},attrTest:function(t){return K.prototype.attrTest.call(this,t)&&(this.state&oi||!(this.state&oi)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Z(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),l(J,K,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ei]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&oi)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),l(te,X,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Je]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(Ae|Se)&&!o)this.reset();else if(t.eventType&Ce)this.reset(),this._timer=s(function(){this.state=ci,this.tryEmit()},e.time,this);else if(t.eventType&Ae)return ci;return hi},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ci&&(t&&t.eventType&Ae?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=pe(),this.manager.emit(this.options.event,this._input)))}}),l(ee,K,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ei]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&oi)}}),l(ie,K,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:ze|Me,pointers:1},getTouchAction:function(){return Q.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(ze|Me)?e=t.velocity:i&ze?e=t.velocityX:i&Me&&(e=t.velocityY),this._super.attrTest.call(this,t)&&i&t.direction&&t.distance>this.options.threshold&&de(e)>this.options.velocity&&t.eventType&Ae},emit:function(t){var e=Z(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),l(ne,X,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ti]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&Ce&&0===this.count)return this.failTimeout();if(n&&o&&i){if(t.eventType!=Ae)return this.failTimeout();var r=this.pTime?t.timeStamp-this.pTime<e.interval:!0,a=!this.pCenter||M(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&r?this.count+=1:this.count=1,this._input=t;var c=this.count%e.taps;if(0===c)return this.hasRequireFailures()?(this._timer=s(function(){this.state=ci,this.tryEmit()},e.interval,this),oi):ci}return hi},failTimeout:function(){return this._timer=s(function(){this.state=hi},this.options.interval,this),hi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ci&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),se.VERSION="2.0.4",se.defaults={domEvents:!1,touchAction:Qe,enable:!0,inputTarget:null,inputClass:null,preset:[[ee,{enable:!1}],[J,{enable:!1},["rotate"]],[ie,{direction:ze}],[Q,{direction:ze},["swipe"]],[ne],[ne,{event:"doubletap",taps:2},["tap"]],[te]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ui=1,di=2;oe.prototype={set:function(t){return a(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?di:ui},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,s=e.curRecognizer;(!s||s&&s.state&ci)&&(s=e.curRecognizer=null);for(var o=0;o<n.length;)i=n[o],e.stopped===di||s&&i!=s&&!i.canRecognizeWith(s)?i.reset():i.recognize(t),!s&&i.state&(oi|ri|ai)&&(s=e.curRecognizer=i),o++}},get:function(t){if(t instanceof X)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(o(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(o(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(g(e,t),1),this.touchAction.update(),this},on:function(t,e){var i=this.handlers;return r(_(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},off:function(t,e){var i=this.handlers;return r(_(t),function(t){e?i[t].splice(g(i[t],e),1):delete i[t]}),this},emit:function(t,e){this.options.domEvents&&ae(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&re(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},a(se,{INPUT_START:Ce,INPUT_MOVE:Ie,INPUT_END:Ae,INPUT_CANCEL:Se,STATE_POSSIBLE:si,STATE_BEGAN:oi,STATE_CHANGED:ri,STATE_ENDED:ai,STATE_RECOGNIZED:ci,STATE_CANCELLED:li,STATE_FAILED:hi,DIRECTION_NONE:xe,DIRECTION_LEFT:Fe,DIRECTION_RIGHT:He,DIRECTION_UP:De,DIRECTION_DOWN:Oe,DIRECTION_HORIZONTAL:ze,DIRECTION_VERTICAL:Me,DIRECTION_ALL:qe,Manager:oe,Input:C,TouchAction:W,TouchInput:L,MouseInput:N,PointerEventInput:B,TouchMouseInput:U,SingleTouchInput:k,Recognizer:X,AttrRecognizer:K,Tap:ne,Pan:Q,Swipe:ie,Pinch:J,Rotate:ee,Press:te,on:p,off:m,each:r,merge:c,extend:a,inherit:l,bindFn:h,prefixed:b}),typeof define==he&&define.amd?define(function(){return se}):"undefined"!=typeof module&&module.exports?module.exports=se:t[i]=se}(window,document,"Hammer");var AccordionInputSection=new Class({Extends:AccordionSection,options:{choice_el_selector:".options .option",default_choice:null},initialize:function(t,e){this.type="input",this.setOptions(e),this.parent(t,this.options),this.swipeable="true"===this.root_el.get("data-swipeable"),this.swipeable&&(this.frame_el=this.root_el.getElement(".swipe-frame"),this.options_el=this.root_el.getElement(".options"),this.options_width=this.options_el.getSize().x,this.hammer=new Hammer(this.options_el,{velocity:.01}),this.hammer.on("swipe",function(t){var e=this.getActiveChoice(),i=this.choices.indexOf(e),n=i+(2===t.direction?1:-1);if(0>n||n>this.choices.length-1)return!1;var s=this.choices[n];this.changeChoice(s)}.bind(this))),this.choices=this._setupChoices(this.options.choice_el_selector),this.dot_els=this.root_el.getElements(".dot[data-value]"),this.detail_els=this.root_el.getElements(".detail[data-value]"),this.complete_headline=this.root_el.getElement(".complete-headline"),this.incomplete_headline=this.root_el.getElement(".incomplete-headline");var i=new URI(document.location).get("data")||{},n=this.options.default_choice||i[this.name]||this.root_el.get("data-default-value");n&&this.changeChoiceByValue(n),this.addEvents({complete:this.updateHeadline.bind(this),uncomplete:this.updateHeadline.bind(this),open:function(){this.swipeable&&this.centerActiveChoice(this.getActiveChoice())}.bind(this)})},_setupChoices:function(t){var e=_.map(this.root_el.getElements(t),function(t){var e={el:t,value:t.get("data-value"),active:!1};return e.data=_.findWhere(ACCORDION_DATA[this.name],{value:e.value}),e.el.getElement(".action").addEvent("click",function(){this.changeChoice(e)}.bind(this)),e}.bind(this));return e},updateHeadline:function(){if(this.isComplete()){var t=this.getActiveChoice().data;_.each(t,function(t,e){var i=this.complete_headline.getElement("[data-name='"+e+"']");i&&i.set("text",t.toString().replace("<br>",""))}.bind(this)),this.complete_headline.addClass("active"),this.incomplete_headline.removeClass("active")}else this.incomplete_headline.addClass("active"),this.complete_headline.removeClass("active")},getActiveChoice:function(){return _.findWhere(this.choices,{active:!0})},getChoiceByValue:function(t){return _.findWhere(this.choices,{value:t})},getDotElByValue:function(t){return _.find(this.dot_els,function(e){return e.get("data-value")===t})},getDetailElsByValue:function(t){return _.filter(this.detail_els,function(e){return e.get("data-value")===t})},getValue:function(){var t=this.getActiveChoice();return t?t:void 0},changeChoice:function(t){_.each(this.choices,function(t){t.el.removeClass("active"),t.active=!1}),t.el.addClass("active"),t.active=!0,this.swipeable&&this.centerActiveChoice(t);var e=this.getDotElByValue(t.value);e&&(_.each(this.dot_els,function(t){t.removeClass("active")}),e.addClass("active"));var i=this.getDetailElsByValue(t.value);return i&&(_.each(this.detail_els,function(t){t.removeClass("active")}),_.each(i,function(t){t.addClass("active")})),this.fireEvent("change",t),this},changeChoiceByValue:function(t){var e=this.getChoiceByValue(t);return this.changeChoice(e),this},centerActiveChoice:function(t){var e=t.el.getSize().x,i=t.el.getPosition(this.frame_el).x,n=this.options_width/2-e/2,s=n-i;this.frame_el.setStyle("left",s)},isValid:function(){return!!this.getValue()}}),AccordionReviewSection=new Class({Extends:AccordionSection,options:{tbody_selector:".content .table .tbody",today_total_selector:".today .total",recurring_total_selector:".recurring .total",interval_selector:".recurring .interval",saving_selector:".today .saving",save_amount_selector:".today .save-amount",new_saving_selector:".saving",new_save_amount_selector:".saving .save-amount",guaranteed_blurb_mobile:".guaranteed-blurb"},data:{},VALID_DATA_KEYS:["timing","bundle","handle"],desktopTableRowTemplate:_.template('<tr>         <td class="image">             <img src="<%= image %>">         </td>         <td class="item">             <p class="name">                 <%= name %>             </p>             <p class="more-info">                 <% _.each(more_info, function (e) { %>                     <%= e %><br>                 <% }); %>             </p>         </td>         <td class="frequency">             <%= frequency %>         </td>         <td class="month-price">             <%= month_price %>         </td>         <td class="ship-price">             <%= ship_price %>         </td>     </tr>'),mobileTableRowTemplate:_.template('<div class="item">         <div class="grid image-info">             <div class="col-1-4 image">                 <img src="<%= image %>">             </div>             <div class="col-3-4 text">                 <p class="name"><%= name %></p>                 <p class="more-info">                     <% _.each(more_info, function (e) { %>                         <%= e %><br>                     <% }); %>                 </p>             </div>         </div>         <div class="grid">             <p class="col-1-2 label">Frequency</p>             <p class="col-1-2 value"><%= frequency %></p>         </div>         <div class="grid">             <p class="col-1-2 label">Price / Month</p>             <p class="col-1-2 value"><%= month_price %></p>         </div>         <div class="grid">             <p class="col-1-2 label">Price / Shipment</p>             <p class="col-1-2 value"><%= ship_price %></p>         </div>     </div>'),initialize:function(t,e){this.type="review",this.options.beforeOpen=function(t){this.updateTable(this.cleanDataForTemplate(this.data)),async.each(this.root_el.getElements("img"),function(t,e){t.complete?e():t.addEvent("load",e)},t)}.bind(this),this.options.beforeClose=function(t){this.new_review_section&&this.new_guaranteed_blurb_el&&this.new_guaranteed_blurb_el.hide(),t()}.bind(this),this.setOptions(e),this.parent(t,this.options),this.tbody_el=this.root_el.getElement(this.options.tbody_selector),this.today_total_el=this.root_el.getElement(this.options.today_total_selector),this.recurring_total_el=this.root_el.getElement(this.options.recurring_total_selector)||$$(this.options.recurring_total_selector),this.interval_el=this.root_el.getElement(this.options.interval_selector)||$$(this.options.interval_selector),this.saving_el=this.root_el.getElement(this.options.saving_selector),this.save_amount_el=this.root_el.getElement(this.options.save_amount_selector),this.new_saving_el=this.root_el.getElement(this.options.new_saving_selector),this.new_save_amount_el=this.root_el.getElement(this.options.new_save_amount_selector),this.new_guaranteed_blurb_el=$$(this.options.guaranteed_blurb_mobile),this.new_review_section=!this.saving_el},setData:function(t,e){this.data[t]=e},updateTable:function(t){this.tbody_el.empty(),_.each(t.line_items,function(t){var e=Harrys.IS_MOBILE?this.mobileTableRowTemplate(t):this.desktopTableRowTemplate(t),i=Elements.from(e)[0];this.tbody_el.adopt(i)}.bind(this)),this.today_total_el.set("text",this.new_review_section?"$"+t.month_total.toFloat().toFixed(2):"$"+t.month_total),this.recurring_total_el.set("text","$"+t.month_total),this.interval_el.set("text",t.interval);var e=this.saving_el||this.new_saving_el;0===t.saving?e.hide():e.show(),this.new_review_section?(this.new_guaranteed_blurb_el&&this.new_guaranteed_blurb_el.show(),0===t.bundle_saving?this.new_save_amount_el.parentElement.hide():this.new_save_amount_el.parentElement.show(),this.new_save_amount_el.set("text","$"+t.bundle_saving.toFloat().toFixed(2))):this.save_amount_el.set("text","$"+t.saving)},cleanDataForTemplate:function(t){var e=this.getLineItems(t),i={interval:this.getInterval(t),line_items:e,month_total:this.getMonthTotal(e),saving:this.getSavingAmount(e),bundle_saving:this.getBundleSavingAmount(e)};return i},getFrequency:function(t){var e;if(t.timing&&(e=t.timing.interval),t.custom&&(e=t.custom.interval/30),e){var i="Every "+e+" Month";return 1!==e.toInt()&&(i+="s"),i}},getMonthPrice:function(t){var e=this.getCost(t);return e?"$"+e.toFloat().toFixed(2):void 0},getShipPrice:function(t){return t.bundle?"$"+t.bundle.cost.toFloat().toFixed(2):void 0},getCost:function(t){return t.bundle&&t.timing?t.bundle.cost.toInt()/t.timing.interval.toInt():void 0},getMonthTotal:function(t){return _.reduce(t,function(t,e){return t+=e.price.toInt()*e.quantity.toInt()},0)},getInterval:function(t){return t.timing?t.timing.interval:t.custom?t.custom.interval/30:void 0},getSavingAmount:function(t){var e=this.getMonthTotal(t),i=_.reduce(t,function(t,e){var i=e.non_bundle_price||e.price;return t+=i.toInt()*e.quantity.toInt()},0);return i-e},getBundleSavingAmount:function(t){var e=this.getMonthTotal(t),i=_.reduce(t,function(t,e){if("Once"!==e.frequency){var i=e.non_bundle_price||e.price;return t+=i.toInt()*e.quantity.toInt()}return t},0);return i-e},getLineItems:function(t){var e=[];return t.handle&&e.push({image:t.handle.image,name:"Truman Razor Handle",more_info:[t.handle.value],price:0,non_bundle_price:10,frequency:"Once",month_price:this.new_review_section?"-":"Free",ship_price:"Free",quantity:1}),t.bundle&&e.push({image:t.bundle.image,name:t.bundle.title,more_info:t.bundle.includes,price:t.bundle.cost,non_bundle_price:t.bundle.non_bundle_cost||t.bundle.cost,frequency:this.getFrequency(t),month_price:this.getMonthPrice(t),ship_price:this.getShipPrice(t),quantity:1}),t.custom&&(e=_.reduce(t.custom,function(e,i,n){if(0===i.toInt())return e;var s="make"+n.capitalize()+"LineItem",o=this[s]&&this[s](i);return o&&(o.frequency=this.getFrequency(t),o.month_price=o.ship_price.toInt()/(t.custom.interval/30).toInt(),o.ship_price="$"+o.ship_price.toFloat().toFixed(2),o.month_price="$"+o.month_price.toFloat().toFixed(2),e.push(o)),e}.bind(this),e)),e},makeBladesLineItem:function(t){var e=Harrys.productsManager.findByPackSize(t);return{image:e.checkout_image,name:e.name,more_info:[e.pack_size+" Pack"],price:e.price,frequency:null,month_price:null,ship_price:e.price,quantity:1}},makeCreamLineItem:function(t){var e=Harrys.productsManager.findByUid(Harrys.productIds.SHAVE_CREAM_THREE_OZ_BLUE),i=e.price*t;return{image:e.checkout_image,name:e.name,more_info:[e.tube_size],price:e.price,frequency:null,month_price:null,ship_price:i,quantity:t}},makeGelLineItem:function(t){var e=Harrys.productsManager.findByUid(Harrys.productIds.SHAVE_GEL_FOUR_OZ),i=e.price*t;return{image:e.checkout_image,name:e.name,more_info:[e.tube_size],price:e.price,frequency:null,month_price:null,ship_price:i,quantity:t}},makeAftershaveLineItem:function(t){var e=Harrys.productsManager.findByUid(Harrys.productIds.PACKAGED_AFTER_SHAVE_ONE_OZ),i=e.price*t;return{image:e.checkout_image,name:e.name,more_info:[e.tube_size],price:e.price,frequency:null,month_price:null,ship_price:i,quantity:t}},setComplete:function(){this.next_button.disable(),Harrys.cart.clear(),this.data.custom&&this.addCustomItemsToCart(this.data.custom),this.data.timing&&this.data.bundle&&this.addBundleItemsToCart(this.data),this.data.handle&&Harrys.cart.addItem(new CartItem({id:Harrys.productsManager.findByUid(this.data.handle.uid).id,quantity:1}),{no_show_mini_cart:!0}),window.location="/checkout"},addCustomItemsToCart:function(t){console.log(t);var e={no_show_mini_cart:!0};t.blades.toInt()>0&&Harrys.cart.addItem(new CartItem({id:Harrys.productsManager.findByPackSize(t.blades).id,quantity:1,customizations:{interval:t.interval}}),e),t.cream.toInt()>0&&Harrys.cart.addItem(new CartItem({id:Harrys.productsManager.findByUid(Harrys.productIds.SHAVE_CREAM_THREE_OZ_BLUE).id,quantity:t.cream,customizations:{interval:t.interval}}),e),t.gel.toInt()>0&&Harrys.cart.addItem(new CartItem({id:Harrys.productsManager.findByUid(Harrys.productIds.SHAVE_GEL_FOUR_OZ).id,quantity:t.gel,customizations:{interval:t.interval}}),e),t.aftershave.toInt()>0&&Harrys.cart.addItem(new CartItem({id:Harrys.productsManager.findByUid(Harrys.productIds.PACKAGED_AFTER_SHAVE_ONE_OZ).id,quantity:t.aftershave,customizations:{interval:t.interval}}),e)},addBundleItemsToCart:function(t){var e={no_show_mini_cart:!0},i=30*this.getInterval(this.data);Harrys.cart.addItem(new CartItem({id:Harrys.productsManager.findByUid(t.bundle.uid).id,quantity:1,customizations:{interval:i}}),e)}}),AccordionCustomSection=new Class({Extends:AccordionSection,options:{},input_names:{blades:{clean:function(t){return t+" blade"}},cream:{clean:function(t){return t+" shave cream"}},gel:{clean:function(t){return t+" foaming gel"}},aftershave:{clean:function(t){return t+" after shave"}},interval:{clean:function(t){return t=t.toInt()/30,t+" month"}}},initialize:function(t,e){this.type="custom",this.setOptions(e),this.parent(t,this.options),this.complete_headline=this.root_el.getElement(".complete-headline"),this.incomplete_headline=this.root_el.getElement(".incomplete-headline");var i=new URI(document.location).get("data")||{};_.each(this.input_names,function(t,e){i[e]&&this.setInputByName(e,i[e])}.bind(this)),this.addEvents({complete:this.updateHeadline.bind(this),uncomplete:this.updateHeadline.bind(this)})},updateHeadline:function(){if(this.isComplete()){var t=this.getValue().data;_.each(t,function(t,e){var i=this.cleanCopyForHeadline(e,t),n=this.complete_headline.getElement("[data-name='"+e+"']");n&&n.set("text",i)}.bind(this)),this.complete_headline.addClass("active"),this.incomplete_headline.removeClass("active")}else this.incomplete_headline.addClass("active"),this.complete_headline.removeClass("active")},cleanCopyForHeadline:function(t,e){var i,n=this.input_names[t].clean;return i="function"===typeOf(n)?n(e):e+" "+t,1!==e.toInt()&&(i+="s"),i},getValue:function(){return{name:this.name,data:_.reduce(this.root_el.getElements("select"),function(t,e){var i=e.get("name"),n=e.get("value");return t[i]=n,t},{})}},setInputByName:function(t,e){return this.root_el.getElement('select[name="'+t+'"]').set("value",e),this},isValid:function(){return!!this.getValue()}}),Modal=new Class({Implements:Events,initialize:function(t){this.rootEl=t;var e=this.rootEl.getElement(".close");e&&e.addEvent("click",function(){this.hide()}.bind(this)),this.rootEl.addEvent("click",function(t){t.target===this.rootEl&&this.hide()}.bind(this))},show:function(){Harrys.IS_MOBILE?this.rootEl.addClass("active"):this.rootEl.setStyle("display","")},hide:function(){Harrys.IS_MOBILE?this.rootEl.removeClass("active"):this.rootEl.setStyle("display","none")}}),MoreInfoModal=new Class({Extends:Modal,initialize:function(t){this.parent(t),this.type=this.rootEl.get("data-modal"),window.addEvent("keyup",function(t){"esc"===t.key&&this.hide()}.bind(this))},setup:function(){return this}}),AccordionCustomizeLink=new Class({section_conversion:{timing:function(t){return{interval:t}
},bundle:function(t){var e=t.split("-");return{blades:_.contains(e,"blades")?8:0,cream:_.contains(e,"cream")?2:0,gel:_.contains(e,"gel")?2:0,aftershave:_.contains(e,"aftershave")?1:0}},handle:function(t){return{handle:t}}},initialize:function(t){this.root_el=t,this.uri=new URI(this.root_el.get("href"))},setData:function(t,e){var i=this.section_conversion[t],n=i(e);return _.each(n,function(t,e){this.uri.setData(e,t)}.bind(this)),this.root_el.set("href",this.uri),this}}),ProductFeatures=new Class({Implements:[Events,Options],options:{action_selector:"[data-product-action]",feature_list_selector:"[data-product-feature-list]",image_selector:"[data-product-image]",dot_selector:"[data-product-dot]"},initialize:function(t,e){this.setOptions(e),this.root_el=t,this.action_els=this.root_el.getElements(this.options.action_selector),this.feature_list_els=this.root_el.getElements(this.options.feature_list_selector),this.image_els=this.root_el.getElements(this.options.image_selector),this.dot_els=this.root_el.getElements(this.options.dot_selector),_.each(this.action_els,function(t){var e=t.get("data-product-action");t.addEvent("mouseover",function(){this.changeActiveProduct(e)}.bind(this))}.bind(this)),this.dot_els.length&&(this.hammer=new Hammer(this.root_el,{velocity:.01}),this.hammer.on("swipe",function(t){var e=this.getActiveDotEl(),i=this.dot_els.indexOf(e),n=i+(2===t.direction?1:-1);if(0>n||n>this.dot_els.length-1)return!1;var s=this.dot_els[n].get("data-product-dot");this.changeActiveProduct(s)}.bind(this)),this.root_el.addEvent("click",function(){var t=this.getActiveDotEl(),e=this.dot_els.indexOf(t),i=e+1;i>this.dot_els.length-1&&(i=0);var n=this.dot_els[i].get("data-product-dot");this.changeActiveProduct(n)}.bind(this)))},changeActiveProduct:function(t){var e=this.getFeatureListElByName(t),i=this.getImageElByName(t),n=this.getActionElByName(t),s=this.getDotElByName(t);this.feature_list_els.removeClass("active"),this.image_els.removeClass("active"),this.action_els.removeClass("active"),this.dot_els.removeClass("active"),e&&e.addClass("active"),i&&i.addClass("active"),n&&n.addClass("active"),s&&s.addClass("active")},getFeatureListElByName:function(t){return _.find(this.feature_list_els,function(e){return t===e.get("data-product-feature-list")}.bind(this))},getImageElByName:function(t){return _.find(this.image_els,function(e){return t===e.get("data-product-image")}.bind(this))},getActionElByName:function(t){return _.find(this.action_els,function(e){return t===e.get("data-product-action")}.bind(this))},getDotElByName:function(t){return _.find(this.dot_els,function(e){return t===e.get("data-product-dot")}.bind(this))},getActiveDotEl:function(){return _.find(this.dot_els,function(t){return t.hasClass("active")})},getActiveProductName:function(){return this.getActiveDotEl().get("data-product-dot")}});window.addEvent("domready",init);var VALID_SECTION_TYPES=["Input","Review","Custom"];